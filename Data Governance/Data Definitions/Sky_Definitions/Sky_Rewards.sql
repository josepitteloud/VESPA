/*###############################################################################
# Created on:   19/09/2012
# Created by:   Tony Kinnaird (TKD)
# Description:  Gives a user a process for defining if the account has used Sky Rewards
#
#################################################################################
# Dependencies
# ------------------------------------------------------------------------------
# (none)
#
#################################################################################
# Change log
# ------------------------------------------------------------------------------
# 19/09/2012  TKD   v01 - initial version
#
###############################################################################*/

-- ##############################################################################################################
-- ##### STEP 1.0 - Process									    #####
-- ##############################################################################################################

---------------------------------------------------------------------------------
--  Customer has used Sky Rewards  [HH_ACTIVE_SKY_REWARDS_USER]
---------------------------------------------------------------------------------
SELECT    base.account_number
         ,1 as Sky_Reward_L12
INTO #Sky_rewards
    FROM sk_prod.SKY_REWARDS_COMPETITIONS as sky
         inner join VIQ_HH_ACCOUNT_TMP as Base
                    on sky.account_number = base.account_number
    WHERE Date_entered >= DATEADD(day,-365,today())
    GROUP BY base.account_number;
commit;

-- ##############################################################################################################
-- ##### STEP 1.0 Ended									    #####
-- ##############################################################################################################



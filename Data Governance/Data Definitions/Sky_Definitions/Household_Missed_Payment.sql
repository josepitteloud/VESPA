/*###############################################################################
# Created on:   21/09/2012
# Created by:   Tony Kinnaird (TKD)
# Description:  Gives a user a process for defining the tenure 
#			of a customer, active periods only
#
#################################################################################
# Dependencies
# ------------------------------------------------------------------------------
# (none)
#
#################################################################################
# Change log
# ------------------------------------------------------------------------------
# 21/09/2012  TKD   v01 - initial version
#
###############################################################################*/

-- ##############################################################################################################
-- ##### STEP 1.0 - Process									    #####
-- ##############################################################################################################

---------------------------------------------------------------------------------
--  Missed Payments Last 12 months  [HH_MISSED_PAYMENT_LAST_YEAR]
---------------------------------------------------------------------------------
SELECT distinct VIQ.account_number, 1 AS miss
INTO #missed
FROM sk_prod.cust_bills AS missed
        inner join VIQ_HH_ACCOUNT_TMP as VIQ
           on missed.account_number = VIQ.account_number
WHERE payment_due_dt <= DATEADD(day,-365,today())
        AND Status = 'Unbilled';
commit;

-- ##############################################################################################################
-- ##### STEP 1.0 Ended									    #####
-- ##############################################################################################################


